module.exports=[59270,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(70069),e=a.i(43690);function f(){let[a,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)("all"),[o,p]=(0,c.useState)({isOpen:!1,id:null}),[q,r]=(0,c.useState)({key:null,direction:"asc"}),[s,t]=(0,c.useState)(10),[u,v]=(0,c.useState)(1),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(!1),A=(0,c.useRef)(null);(0,c.useEffect)(()=>{let a=a=>{A.current&&a.target instanceof Node&&!A.current.contains(a.target)&&z(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[A]);let[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(null),F=async()=>{let a=await fetch("/dashboard/requests/api");f(await a.json())};(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/dashboard/requests/api"),b=await a.json();f(b)}catch(a){console.error("Failed to fetch requests:",a)}})()},[]);let G=async a=>{try{(await fetch("/dashboard/requests/api",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a})})).ok?((0,e.addToast)("Request deleted successfully!","success"),F(),h(null)):(0,e.addToast)("Failed to delete request","error")}catch(a){console.error("Delete failed:",a),(0,e.addToast)("Error deleting request","error")}p({isOpen:!1,id:null})},H=async a=>{try{(await fetch("/dashboard/requests/api",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,status:"resolved"})})).ok?((0,e.addToast)("Request marked as resolved!","success"),F(),h(null)):(0,e.addToast)("Failed to resolve request","error")}catch(a){console.error("Resolve failed:",a),(0,e.addToast)("Error resolving request","error")}},I=(a,b)=>{let c="contact"===a||"phone"===a?(0,d.filterPhoneInput)(b):b;k&&l({...k,[a]:c})},J=async()=>{if(k)try{(await fetch("/dashboard/requests/api",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)})).ok?((0,e.addToast)("Request updated successfully!","success"),j(!1),l(null),F()):(0,e.addToast)("Failed to update request","error")}catch(a){console.error("Update failed:",a),(0,e.addToast)("Error updating request","error")}},K=a.filter(a=>("active"!==m||"resolved"!==a.status)&&("resolved"!==m||"resolved"===a.status)&&(!B||""===B||(a.category||"")===B)&&(!D||""===D||(a.priority||"")===D)&&(!w||""===w.trim()||!!(a.title||"").toString().toLowerCase().includes(w.trim().toLowerCase()))&&!0),L=(0,c.useMemo)(()=>Array.from(new Set(a.map(a=>a.category).filter(Boolean))),[a]),M=(0,c.useMemo)(()=>{let a=[...K];if(!q.key)return a;let b="asc"===q.direction?1:-1,c=a=>{if(!a)return 2;let b=String(a).toLowerCase();return"low"===b?1:"medium"===b?2:"high"===b?3:2};return a.sort((a,d)=>{let e=q.key;if("category"===e){let c=(a.category||"").toString().toLowerCase(),e=(d.category||"").toString().toLowerCase();return c<e?-1*b:c>e?+b:a.id-d.id}if("priority"===e){let e=c(a.priority),f=c(d.priority);return e<f?-1*b:e>f?+b:a.id-d.id}if("status"===e){let c=+("resolved"===a.status),e=+("resolved"===d.status);return c<e?-1*b:c>e?+b:a.id-d.id}return 0}),a},[K,q]),N=M.length,O=Math.max(1,Math.ceil(N/s)),P=Math.min(u,O),Q=(0,c.useMemo)(()=>{let a=(P-1)*s;return M.slice(a,a+s)},[M,P,s]),R=a=>{h(null),p({isOpen:!1,id:null}),r(b=>b.key!==a?(v(1),{key:a,direction:"asc"}):(v(1),{key:a,direction:"asc"===b.direction?"desc":"asc"}))};return(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-6 text-gray-800",children:"Requests"}),(0,b.jsxs)("div",{className:"mb-4 flex items-center",children:[(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("button",{onClick:()=>{n("active"),h(null),v(1)},className:`px-4 py-2 rounded-lg font-medium transition cursor-pointer ${"active"===m?"bg-blue-600 text-white":"bg-gray-200 text-gray-800 hover:bg-gray-300"}`,children:["Active (",a.filter(a=>"resolved"!==a.status).length,")"]}),(0,b.jsxs)("button",{onClick:()=>{n("resolved"),h(null),v(1)},className:`px-4 py-2 rounded-lg font-medium transition cursor-pointer ${"resolved"===m?"bg-green-600 text-white":"bg-gray-200 text-gray-800 hover:bg-gray-300"}`,children:["Resolved (",a.filter(a=>"resolved"===a.status).length,")"]}),(0,b.jsxs)("button",{onClick:()=>{n("all"),h(null),v(1)},className:`px-4 py-2 rounded-lg font-medium transition cursor-pointer ${"all"===m?"bg-gray-800 text-white":"bg-gray-200 text-gray-800 hover:bg-gray-300"}`,children:["All (",a.length,")"]})]}),(0,b.jsxs)("div",{className:"ml-auto relative",ref:A,children:[(0,b.jsxs)("div",{className:"flex items-center bg-white border border-gray-300 px-3 py-1 shadow-sm w-80 cursor-text "+(y?"rounded-t-lg border-b-0":"rounded-lg"),onClick:()=>z(!0),children:[(0,b.jsx)("svg",{className:"w-5 h-5 text-gray-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15z"})}),(0,b.jsx)("input",{value:w,onChange:a=>{x(a.target.value),v(1),h(null)},placeholder:"Search",className:"w-full outline-none text-gray-800 placeholder-gray-400",onFocus:()=>z(!0)}),w&&(0,b.jsx)("button",{onClick:()=>{x(""),v(1)},className:"ml-2 text-sm text-gray-500","aria-label":"Clear search",children:"×"})]}),y&&(0,b.jsx)("div",{className:"absolute right-0 top-full mt-0 w-80 bg-white border border-gray-200 rounded-b-lg p-3 shadow-lg z-50",children:(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 mb-2 font-semibold",children:"Category"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:L.map(a=>(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("button",{onClick:()=>{C(b=>b===a?null:a),v(1),h(null)},className:`min-w-22 flex items-center justify-center px-3 py-1 rounded-full text-sm border ${B===a?"bg-gray-900 text-white":"bg-white text-gray-700"}`,children:(0,b.jsx)("span",{className:"truncate",children:a})}),B===a&&(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),C(null),v(1)},className:"absolute -top-1 -right-1 bg-red-600 text-white rounded-full w-4 h-4 flex items-center justify-center text-[10px] shadow","aria-label":`Remove category ${a}`,title:"Remove",children:"×"})]},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 mb-2 font-semibold",children:"Priority"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:[{value:"Low",label:"Low"},{value:"Medium",label:"Mid"},{value:"High",label:"High"}].map(a=>(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("button",{onClick:()=>{E(b=>b===a.value?null:a.value),v(1),h(null)},className:`min-w-22 flex items-center justify-center px-3 py-1 rounded-full text-sm border ${D===a.value?"bg-gray-900 text-white":"bg-white text-gray-700"}`,children:(0,b.jsx)("span",{className:"truncate",children:a.label})}),D===a.value&&(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),E(null),v(1)},className:"absolute -top-1 -right-1 bg-red-600 text-white rounded-full w-4 h-4 flex items-center justify-center text-[10px] shadow","aria-label":`Remove priority ${a.value}`,title:"Remove",children:"×"})]},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 mb-2 font-semibold",children:"Status"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:["active","resolved"].map(a=>(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("button",{onClick:()=>{n(a),v(1),h(null)},className:`min-w-22 flex items-center justify-center px-3 py-1 rounded-full text-sm border ${m===a?"bg-gray-900 text-white":"bg-white text-gray-700"}`,children:(0,b.jsx)("span",{className:"truncate",children:"active"===a?"Active":"Resolved"})}),m===a&&(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),n("all"),v(1)},className:"absolute -top-1 -right-1 bg-red-600 text-white rounded-full w-4 h-4 flex items-center justify-center text-[10px] shadow","aria-label":`Remove status ${a}`,title:"Remove",children:"×"})]},a))})]}),(0,b.jsx)("div",{className:"col-span-3 mt-2",children:(0,b.jsx)("div",{className:"mt-1",children:(0,b.jsx)("button",{onClick:()=>{C(null),E(null),n("all"),h(null)},className:"px-3 py-1 rounded text-sm bg-gray-100 text-gray-800 border border-gray-200",children:"Clear"})})})]})})]})]}),(0,b.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-gray-900 text-white",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-4 text-left font-semibold",children:"Title"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left font-semibold",children:(0,b.jsxs)("button",{className:"flex items-center gap-2",onClick:()=>R("category"),children:[(0,b.jsx)("span",{children:"Category"}),(0,b.jsx)("span",{className:"ml-2",children:(0,b.jsx)("span",{className:"inline-flex items-center justify-center w-6 h-6 text-xs rounded border transition-colors "+("category"===q.key?"bg-white text-gray-900 border-gray-200":"bg-transparent text-gray-300 border-gray-400"),"aria-hidden":!0,children:"category"===q.key?"asc"===q.direction?"▲":"▼":"↕"})})]})}),(0,b.jsx)("th",{className:"px-6 py-4 text-left font-semibold",children:(0,b.jsxs)("button",{className:"flex items-center gap-2",onClick:()=>R("priority"),children:[(0,b.jsx)("span",{children:"Priority"}),(0,b.jsx)("span",{className:"ml-2",children:(0,b.jsx)("span",{className:"inline-flex items-center justify-center w-6 h-6 text-xs rounded border transition-colors "+("priority"===q.key?"bg-white text-gray-900 border-gray-200":"bg-transparent text-gray-300 border-gray-400"),"aria-hidden":!0,children:"priority"===q.key?"asc"===q.direction?"▲":"▼":"↕"})})]})}),(0,b.jsx)("th",{className:"px-6 py-4 text-left font-semibold",children:(0,b.jsxs)("button",{className:"flex items-center gap-2",onClick:()=>R("status"),children:[(0,b.jsx)("span",{children:"Status"}),(0,b.jsx)("span",{className:"ml-2",children:(0,b.jsx)("span",{className:"inline-flex items-center justify-center w-6 h-6 text-xs rounded border transition-colors "+("status"===q.key?"bg-white text-gray-900 border-gray-200":"bg-transparent text-gray-300 border-gray-400"),"aria-hidden":!0,children:"status"===q.key?"asc"===q.direction?"▲":"▼":"↕"})})]})}),(0,b.jsx)("th",{className:"px-6 py-4 text-center font-semibold",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:Q.map(a=>(0,b.jsxs)("tr",{className:"border-b hover:bg-gray-50 transition",children:[(0,b.jsx)("td",{className:"px-6 py-4 font-medium text-gray-800",children:a.title}),(0,b.jsx)("td",{className:"px-6 py-4 text-gray-700",children:(0,b.jsx)("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:a.category})}),(0,b.jsx)("td",{className:"px-6 py-4 text-gray-700",children:(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${"High"===a.priority?"bg-red-100 text-red-800":"Medium"===a.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:a.priority||"N/A"})}),(0,b.jsx)("td",{className:"px-6 py-4 text-gray-700",children:(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${"resolved"===a.status?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:"resolved"===a.status?"Resolved":"Active"})}),(0,b.jsx)("td",{className:"px-6 py-4 text-center",children:(0,b.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>h(a),title:"View","aria-label":"View request",className:"w-9 h-9 flex items-center justify-center rounded border transition cursor-pointer bg-blue-700 hover:bg-blue-800 text-white",children:(0,b.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5s8.268 2.943 9.542 7c-1.274 4.057-5.065 7-9.542 7S3.732 16.057 2.458 12z"})]})}),"resolved"!==a.status&&(0,b.jsx)("button",{onClick:()=>H(a),title:"Mark resolved","aria-label":"Mark request as resolved",className:"w-9 h-9 flex items-center justify-center rounded border transition cursor-pointer bg-green-700 hover:bg-green-800 text-white",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),(0,b.jsx)("button",{onClick:()=>p({isOpen:!0,id:a.id}),title:"Delete","aria-label":"Delete request",className:"w-9 h-9 flex items-center justify-center rounded border transition cursor-pointer bg-red-700 hover:bg-red-800 text-white",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M1 7h22M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3"})})})]})})]},a.id))})]})}),0===N&&(0,b.jsxs)("div",{className:"mt-6 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded",children:[(0,b.jsx)("p",{className:"text-sm text-yellow-800",children:"No requests found for the current filters."}),(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsx)("button",{onClick:()=>{C(null),E(null),n("all"),x(""),h(null)},className:"px-3 py-1 bg-white border rounded text-sm",children:"Clear filters"})})]}),g&&(0,b.jsxs)("div",{className:"mt-8 p-6 bg-white rounded-lg shadow-md border-l-4 border-blue-600",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Request Details"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{className:"bg-amber-700 hover:bg-amber-800 text-white px-4 py-2 rounded font-medium transition cursor-pointer",onClick:()=>{h(null),l({...g}),j(!0)},children:"Edit"}),(0,b.jsx)("button",{className:"text-gray-500 hover:text-gray-700 text-2xl cursor-pointer",onClick:()=>h(null),children:"×"})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-6",children:Object.entries(g).map(([a,c])=>"id"===a?null:(0,b.jsxs)("div",{className:"border-b pb-3",children:[(0,b.jsx)("p",{className:"text-sm text-gray-600 font-semibold uppercase",children:a}),(0,b.jsx)("p",{className:"text-lg text-gray-800 mt-1",children:c||"N/A"})]},a))})]}),i&&k&&(0,b.jsxs)("div",{className:"mt-8 p-6 bg-white rounded-lg shadow-lg border-l-4 border-gray-900",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Edit Request"}),(0,b.jsx)("button",{className:"text-gray-500 hover:text-gray-700 text-2xl",onClick:()=>{j(!1),l(null)},children:"×"})]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-6",children:Object.entries(k).map(([a,c])=>{if("id"===a)return null;let e=(0,d.getFieldInputType)(a),f=(0,d.getFieldPattern)(a);return(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2 uppercase",children:a}),"description"===a?(0,b.jsx)("textarea",{value:c||"",onChange:b=>I(a,b.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900 min-h-32",placeholder:`Enter ${a}`}):"priority"===a?(0,b.jsxs)("select",{value:c||"",onChange:b=>I(a,b.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900 cursor-pointer",children:[(0,b.jsx)("option",{value:"",children:"Select Priority"}),(0,b.jsx)("option",{value:"High",children:"High"}),(0,b.jsx)("option",{value:"Medium",children:"Medium"}),(0,b.jsx)("option",{value:"Low",children:"Low"})]}):(0,b.jsx)("input",{type:e,value:c||"",onChange:b=>I(a,b.target.value),pattern:f,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900",placeholder:`Enter ${a}`,title:"tel"===e?"Phone number can contain numbers, dashes, parentheses, and plus sign":""})]},a)})}),(0,b.jsxs)("div",{className:"sticky bottom-0 bg-gray-100 px-6 py-4 flex justify-end gap-3",children:[(0,b.jsx)("button",{className:"px-6 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium rounded-lg transition cursor-pointer",onClick:()=>{j(!1),l(null)},children:"Cancel"}),(0,b.jsx)("button",{className:"px-6 py-2 bg-gray-900 hover:bg-black text-white font-medium rounded-lg transition cursor-pointer",onClick:J,children:"Save Changes"})]})]}),o.isOpen&&(0,b.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-40 pointer-events-none",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full mx-4 pointer-events-auto",children:[(0,b.jsx)("div",{className:"bg-red-50 px-6 py-4 border-b border-red-200",children:(0,b.jsx)("h2",{className:"text-xl font-bold text-red-700",children:"Delete Request"})}),(0,b.jsxs)("div",{className:"px-6 py-6",children:[(0,b.jsx)("p",{className:"text-gray-700 text-base mb-4",children:"Are you sure you want to delete this request? This action cannot be undone."}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"The request will be marked as deleted and will no longer appear in your dashboard."})]}),(0,b.jsxs)("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-end gap-3",children:[(0,b.jsx)("button",{className:"px-6 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium rounded-lg transition cursor-pointer",onClick:()=>p({isOpen:!1,id:null}),children:"Cancel"}),(0,b.jsx)("button",{className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition cursor-pointer",onClick:()=>{o.id&&G(o.id)},children:"Delete"})]})]})}),(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:["Showing ",Math.min((u-1)*s+1,N||0)," - ",Math.min(u*s,N)," of ",N]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>v(a=>Math.max(1,a-1)),disabled:1===u,className:`px-3 py-1 rounded ${1===u?"bg-gray-200 text-gray-400":"bg-gray-800 text-white"}`,children:"Prev"}),(0,b.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:O}).map((a,c)=>{let d=c+1;return O>7&&1!==d&&d!==O&&Math.abs(d-u)>2?null:(0,b.jsx)("button",{onClick:()=>v(d),className:`w-8 h-8 flex items-center justify-center rounded ${d===u?"bg-gray-900 text-white":"bg-white text-gray-700 border"}`,children:d},d)})}),(0,b.jsx)("button",{onClick:()=>v(a=>Math.min(O,a+1)),disabled:u===O,className:`px-3 py-1 rounded ${u===O?"bg-gray-200 text-gray-400":"bg-gray-800 text-white"}`,children:"Next"})]})]})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=src_app_dashboard_requests_page_tsx_d6a7e608._.js.map